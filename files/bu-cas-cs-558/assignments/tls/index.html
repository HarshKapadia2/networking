<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.18">
<meta name="author" content="Harsh Gaurang Kapadia">
<link rel="icon" type="image/x-icon" href="../../../../favicon.ico">
<title>Transport Layer Security (TLS)</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.square{list-style-type:square}
ul.circle ul:not([class]),ul.disc ul:not([class]),ul.square ul:not([class]){list-style:inherit}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>Transport Layer Security (TLS)</h1>
<div class="details">
<span id="author" class="author">Harsh Gaurang Kapadia</span><br>
<span id="email" class="email"><a href="mailto:harshk@bu.edu">harshk@bu.edu</a></span><br>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_review_questions">Review Questions</a>
<ul class="sectlevel2">
<li><a href="#_network_traffic_interception">Network Traffic Interception</a></li>
<li><a href="#_tls_protection">TLS Protection</a></li>
<li><a href="#_importance_of_certificates_in_tls">Importance of Certificates in TLS</a></li>
</ul>
</li>
<li><a href="#_tinkering_with_tls">Tinkering with TLS</a>
<ul class="sectlevel2">
<li><a href="#_missing_client_random_value">Missing <code>client_random</code> Value</a></li>
<li><a href="#_missing_server_random_value">Missing <code>server_random</code> Value</a></li>
<li><a href="#_missing_hash_value">Missing Hash Value</a></li>
</ul>
</li>
<li><a href="#_tricking_your_browser">Tricking Your Browser</a>
<ul class="sectlevel2">
<li><a href="#_certificate_authority">Certificate Authority</a></li>
<li><a href="#_target_domain">Target Domain</a></li>
<li><a href="#_creating_a_certificate_for_the_target_domain">Creating a Certificate for the Target Domain</a></li>
<li><a href="#_configuring_host_operating_system">Configuring Host Operating System</a></li>
<li><a href="#_accessing_the_target_domain">Accessing the Target Domain</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_review_questions"><a class="anchor" href="#_review_questions"></a>Review Questions</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<a href="./tls.html#review-questions">Assignment questions and instructions</a>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_network_traffic_interception"><a class="anchor" href="#_network_traffic_interception"></a>Network Traffic Interception</h3>
<div class="paragraph">
<p>(Q 1.1)</p>
</div>
<div class="paragraph">
<p>Ways in which an attacker can intercept network traffic</p>
</div>
<div class="ulist">
<ul>
<li>
<p>ARP Spoofing</p>
</li>
<li>
<p>DNS Cache Poisoning</p>
</li>
<li>
<p>Attacks on BGP</p>
<div class="ulist">
<ul>
<li>
<p>One-hop Attack</p>
</li>
<li>
<p>Sub-prefix Hijacking</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>All the attacks listed above cause packets to be routed to a machine controlled by the attacker (interception), so that they can read and/or manipulate traffic, and monitor activity and/or carry out attacks.</p>
</div>
<div class="paragraph">
<p>Attackers can usually cause most damage when they are in the same local network as their victims, which is why everyone cautions against using public WiFi Access Points for insecure HTTP browsing and sensitive internet usage, such as internet banking.</p>
</div>
</div>
<div class="sect2">
<h3 id="_tls_protection"><a class="anchor" href="#_tls_protection"></a>TLS Protection</h3>
<div class="paragraph">
<p>(Q 1.2)</p>
</div>
<div class="paragraph">
<p>Protections TLS provides to reduce problems caused by interceptions</p>
</div>
<div class="ulist">
<ul>
<li>
<p>TLS makes use of <a href="https://networking.harshkapadia.me/cryptography#digital-certificates-and-certificate-revocation-ocsp-and-crl">Digital Certificates</a> to prove identity, so an interception attempt will fail, because the attacker will not be able to provide a valid certificate for the actual server.</p>
</li>
<li>
<p>TLS includes random values in its messages and uses those values in its integrity checking, so even if an attacker is recording all messages, they cannot replay them, as the server will generate a different random value for every connection, which will lead to the handshake failing.</p>
</li>
<li>
<p>TLS uses the <a href="https://networking.harshkapadia.me/cryptography#diffie-hellman">Diffie-Hellman (DH) Key Exchange Algorithm</a> to exchange key generation material and the algorithm has been created such that the master secret cannot be created by someone intercepting the connection.</p>
<div class="ulist">
<ul>
<li>
<p><a href="https://networking.harshkapadia.me/cryptography#perfect-forward-secrecy">Perfect Forward Secrecy</a> is also provided by TLS connections using the Ephemeral DH (DHE) Key Exchange Algorithm, which implies that even if the attacker is able to compromise the key material of the current TLS session, they cannot compromise the previous or future connections using those values.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Once new keys are generated on both ends at the end of a TLS handshake, TLS encrypts all the handshake messages on both ends and sends it across in a Finished message. The client and the server compare these exchanged encrypted messages and only if they match, does the handshake succeed. An attacker who has intercepted a message and modified it will be caught here, as they cannot change the encrypted 'Finished' message.</p>
</li>
<li>
<p>After the handshake is complete, TLS encrypts and MACs all application data, so an attacker cannot understand the data being shared and cannot even mess with the encrypted data due to the MAC signature.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_importance_of_certificates_in_tls"><a class="anchor" href="#_importance_of_certificates_in_tls"></a>Importance of Certificates in TLS</h3>
<div class="paragraph">
<p>(Q 1.3)</p>
</div>
<div class="paragraph">
<p><a href="https://networking.harshkapadia.me/cryptography#digital-certificates-and-certificate-revocation-ocsp-and-crl">Digital Certificates</a> are a key component of TLS, as they provide authentication, i.e., they prove that the server the client is communicating with, is actually the server that they requested and not someone impersonating the server.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
If an impersonating server sends another server&#8217;s certificate to the client, the impersonating server won&#8217;t be able to produce a valid signature for the Diffie-Hellman <code>g^b</code> value that it sends to the client, as it does not have access to the private key of that certificate to create a valid signature.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>So, a LOT of the security of TLS is dependent on the client verifying the server&#8217;s certificate chain. In the absence of this, anyone can impersonate the real server. An attacker can intercept messages and can carry out a Monkey in the Middle (MITM) Attack.</p>
</div>
<div class="paragraph">
<p>In a certificate chain, each certificate is signed by the certificate having higher authority that it and this finally ends at the root certificate by a Certificate Authority (CA), which has the highest authority and is self-signed. This self-signed root certificate is a trusted certificate that ships with Operating Systems and browsers.</p>
</div>
<div class="paragraph">
<p>Generally when attackers want to play mischief and impersonate a site, they cannot get a CA to sign their fake impersonated certificate (because a real certificate for that site exists and the attacker is not the owner of the actual domain), so attackers self-sign their fake certificate. Web browsers and protocols are smart-enough to realise that a self-signed certificate that is not signed by any trusted CAs signals security issues and so does not let the user access the site.</p>
</div>
<div class="paragraph">
<p>So if the signature verification is skipped, then an attacker presenting a fake self-signed certificate will not be caught and a successful MITM Attack can be carried out.</p>
</div>
<div class="paragraph">
<p>The MITM Attack:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The client starts communication with the server by first establishing a TCP connection with it and then sending a Client Hello message.</p>
</li>
<li>
<p>The server responds with a Server Hello message and its certificates.</p>
</li>
<li>
<p>The attacker will replace the legitimate certificate chain with its own fake self-signed certificate, change and sign the Diffie-Hellman parameter sent by the server (<code>g^b</code> to <code>g^b'</code>) using the public key in the fake certificate and then send it to the client.</p>
</li>
<li>
<p>As the client is not verifying the signature on the certificate it is being presented, it accepts the fake certificate, fake signature and malicious <code>g^b'</code> pre-master secret, and successfully verifies the pre-master secret (<code>g^b'</code>) using the public key in the fake certificate.</p>
</li>
<li>
<p>The attacker then compromises the Client Key Exchange message, where instead of the server receiving <code>g^a</code> from the client, it receives <code>g^a'</code> from the attacker, as the attacker has intercepted the actual value (<code>g^a</code>).</p>
</li>
<li>
<p>Thus, the attacker was able to generate a different set of keys for the client (<code>g^ab'</code>) and the server (<code>g^a'b</code>), and every time messages are exchanged between the two, it will decrypt the intercepted messages, make modifications as necessary, encrypt them again and send them across.</p>
</li>
<li>
<p>The attacker then encrypts and MACs the client and server Finished messages, thus acting as a transparent proxy, unbeknownst to the two communicating parties.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_tinkering_with_tls"><a class="anchor" href="#_tinkering_with_tls"></a>Tinkering with TLS</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<a href="./tls.html#tinkering-with-tls">Assignment questions and instructions</a>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_missing_client_random_value"><a class="anchor" href="#_missing_client_random_value"></a>Missing <code>client_random</code> Value</h3>
<div class="paragraph">
<p>(Q 2.1)</p>
</div>
<div class="paragraph">
<p>The protocol is secure against Replay Attacks even with the <code>client_random</code> value missing, due to the presence of the <code>server_random</code> value.</p>
</div>
<div class="paragraph">
<p>If an attacker decides to replay client messages, the server will send a different server random value each time, so the generated master secret will be different each time, leading to the generation of different messages, message hashes and cipher texts, which will cause the TLS handshake to fail in the final Finished message stage.</p>
</div>
</div>
<div class="sect2">
<h3 id="_missing_server_random_value"><a class="anchor" href="#_missing_server_random_value"></a>Missing <code>server_random</code> Value</h3>
<div class="paragraph">
<p>(Q 2.2)</p>
</div>
<div class="paragraph">
<p>TLS 1.2 is not secure against Replay Attacks if Key Encapsulation or Static Diffie-Hellman (DH) Key Exchange Algorithm are used to exchange keys, but TLS 1.2 is secure against Replay Attacks if the Ephemeral Diffie-Hellman (DHE) Key Exchange Algorithm is used.</p>
</div>
<div class="sect3">
<h4 id="_key_encapsulation_or_static_dh"><a class="anchor" href="#_key_encapsulation_or_static_dh"></a>Key Encapsulation or Static DH</h4>
<div class="paragraph">
<p>When a TLS handshake is using Key Encapsulation or Static DH, an attacker can replay client messages to have the server generate the same responses every time messages are replayed, thus allowing Replay Attacks.</p>
</div>
<div class="paragraph">
<p>Replay attacks allow the attacker to repeat the encrypted application data communication with the server, which can cause some unwanted repeated actions on user data, depending on the contents of the request. The attacker will not be able to read and understand the encrypted data, but they don&#8217;t need to do that to cause harm. They can keep doing these attacks for a lot of connections and they will eventually replay a message that modifies the state of a user&#8217;s data, thus causing problems.</p>
</div>
<div class="paragraph">
<p>To carry out this attack, the attacker has to</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Capture and store all messages of a TLS communication.</p>
</li>
<li>
<p>Establish a TCP connection with the server.</p>
</li>
<li>
<p>Blindly replay all the stored messages (the ones sent from the client to the server) without changing their contents, one-by-one in order of timestamp as the server keeps responding.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The attacker has to send the following intercepted messages unchanged one-by-one in order, after creating a TCP connection with the server:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Client Hello</p>
</li>
<li>
<p>Client Key Exchange</p>
</li>
<li>
<p>Finished</p>
</li>
<li>
<p>Application data</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_dhe"><a class="anchor" href="#_dhe"></a>DHE</h4>
<div class="paragraph">
<p>With the Ephemeral Diffie-Hellman (DHE) Key Exchange Algorithm, new key generation material is generated for every connection, to maintain <a href="https://networking.harshkapadia.me/cryptography#perfect-forward-secrecy">Perfect Forward Secrecy</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
It is being assumed that the server does not cache the key generation material (<code>b</code>, <code>g</code>, <code>p</code>, <code>g^b</code>, etc.).
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This means that if no caching is assumed, the absence of the <code>server_random</code> value does not make TLS 1.2 vulnerable to Replay Attacks. The newly generated Key Exchange parameters provide the same protection as the <code>server_random</code> value does.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_missing_hash_value"><a class="anchor" href="#_missing_hash_value"></a>Missing Hash Value</h3>
<div class="paragraph">
<p>(Q 2.3)</p>
</div>
<div class="paragraph">
<p>TLS 1.2 is vulnerable to Downgrade attacks whether hashes are present or not, but missing hash values in the handshake makes it easier to carry out these attacks, as it is an important checking mechanism against tampering.</p>
</div>
<div class="paragraph">
<p>An attacker intercepting communication can modify a TLS Client Hello message and strip out all the strong cipher suites and just use weak ones. The server then choses the best one out of the weak cipher suites it receives. The attacker records all the parameters that it receives and can trivially figure out the keys due to the weak ciphers used. Thus, the attacker can now selectively encrypt, decrypt and modify messages and transparently read and/or modify messages without anyone noticing.</p>
</div>
<div class="paragraph">
<p>The presence of hashes in the Finished message just slows down the attacker as it has to compute a new hash (which is computer from a version of all messages exchanged in the handshake that includes the modifications it made to all the previous messages). This can cause timeout issues leading to handshake failure, but the absence of hashes eases some of that burden on the attacker, speeding up the attack, thus leading to better chances of the attack succeeding.</p>
</div>
<div class="paragraph">
<p>The attack steps:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./img/tls-12-downgrade-attack.png" alt="tls 12 downgrade attack">
</div>
</div>
<div class="paragraph">
<p><a href="https://blog.cloudflare.com/rfc-8446-aka-tls-1-3" target="_blank" rel="noopener">Image source</a></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_tricking_your_browser"><a class="anchor" href="#_tricking_your_browser"></a>Tricking Your Browser</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p><a href="./tls.html#tricking-your-browser">Assignment questions and instructions</a></p>
</li>
<li>
<p><a href="/cryptography#digital-certificates-and-certificate-revocation-ocsp-and-crl">More on Digital Certificates</a></p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Hijacking a domain on a local by issuing fake certificates.</p>
</div>
<div class="sect2">
<h3 id="_certificate_authority"><a class="anchor" href="#_certificate_authority"></a>Certificate Authority</h3>
<div class="ulist">
<ul>
<li>
<p>Create a directory for all Certificate Authority (CA) information. (<code>bucs558-ca</code> here.)</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">X:\ms-bu\sem-2\bu-cas-cs-558\cert-hw&gt;mkdir bucs558-ca
X:\ms-bu\sem-2\bu-cas-cs-558\cert-hw&gt;cd bucs558-ca</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>The CA&#8217;s certificate and private key have been provided in <a href="./tls.html#tricking-your-browser">the assignment</a>. Paste the contents in two separate files <code>bucs558-ca.crt</code> and <code>bucs558-ca.key</code> respectively.</p>
</li>
<li>
<p>It is easy to extract the public key of the CA from its private key</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">X:\ms-bu\sem-2\bu-cas-cs-558\cert-hw\bucs558-ca&gt;openssl rsa -in bucs558-ca.key -pubout -out bucs558-ca.pubkey
writing RSA key

X:\ms-bu\sem-2\bu-cas-cs-558\cert-hw\bucs558-ca&gt;cat bucs558-ca.pubkey
-----BEGIN PUBLIC KEY-----
MIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEA3ak32ELiqRv/7SQ1r1Hn
DKVfnepIMuQ4n1OKjhx0IMJ9MjZtnf2UA4P/M8LS9cfAoKCbl3GNVjfkzajCDIay
m4u+8FLRgau5UCDaEPcwvMasQsOzuBBvrSkra5bQzMZDTiBxrrSuUVJ1G7lmghP4
4Eu4VD1D6U9VtZbyrDLmGGQT5YJphlF5hphYK3MQndJZxmdLK66BdtuOAg9gNg6n
Sm+balUdRFBZy4TIVp2GR2Bc/XxVukekb6rIMPHIfVZv1Q/U3ZcTV7myk4hW3ewJ
/Sm793ZcxbLW+uIogSd2mjUTfNGK1t24Xw8bXyL8mz3H5Lb9KTFhZ1pNJ0XscgnZ
GrEeg+OcqX6n5i35VJHNzuDaN7jgVSFDDzKOxWGVkd2GTPdBXWJArna92MEHBIkR
3MQu5gOODpKKTnvylO62s0FLMBwWofNVahC6s1F0dHxMP/vEIGP/+FUIfHh8XAml
kvZ3hMZBwJF1+zp5Pi9n+A3uGQ0sXztch7ARTRzvZ/XcPR78vkp4kVfwBcIL2t6q
TA1SbP2IsoYnb9hHOoHwhkBt8DnsksDmgoZOSLeBALHVbgpyhich8rSlUN5nX1XP
NUYZl42MugOE8hrfZ0187/fDxM3VSFdwzyy+mYRcZWKctlmnvRtpFopYxHsxj3/a
DQT48GdOOOItzLsL49ZlEUMCAwEAAQ==
-----END PUBLIC KEY-----</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Details of the provided CA certificate can be found as shown below.</p>
<div class="ulist">
<ul>
<li>
<p>The CA e-mail is <code>unsavorycaffine@bu.edu</code>.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">X:\ms-bu\sem-2\bu-cas-cs-558\cert-hw\bucs558-ca&gt;openssl x509 -in bucs558-ca.crt -noout -text
Certificate:
    Data:
        Version: 3 (0x2)
        Serial Number:
            bc:c7:dc:99:cc:50:0f:30
        Signature Algorithm: sha256WithRSAEncryption
        Issuer: C = US, ST = MA, L = Boston, O = BostonUniversityCS558, OU = CS558, CN = cs558.bu.edu, emailAddress = unsavorycaffine@bu.edu
        Validity
            Not Before: Apr  3 21:49:43 2023 GMT
            Not After : May  3 21:49:43 2023 GMT
        Subject: C = US, ST = MA, L = Boston, O = BostonUniversityCS558, OU = CS558, CN = cs558.bu.edu, emailAddress = unsavorycaffine@bu.edu
        Subject Public Key Info:
            Public Key Algorithm: rsaEncryption
                RSA Public-Key: (4096 bit)
                Modulus:
                    00:dd:a9:37:d8:42:e2:a9:1b:ff:ed:24:35:af:51:
                    e7:0c:a5:5f:9d:ea:48:32:e4:38:9f:53:8a:8e:1c:
                    ...
                    da:0d:04:f8:f0:67:4e:38:e2:2d:cc:bb:0b:e3:d6:
                    65:11:43
                Exponent: 65537 (0x10001)
        X509v3 extensions:
            X509v3 Subject Key Identifier:
                17:48:AD:B7:D1:C5:FA:7E:74:EC:40:0E:3A:A8:6D:D9:CE:B8:7E:EF
            X509v3 Authority Key Identifier:
                keyid:17:48:AD:B7:D1:C5:FA:7E:74:EC:40:0E:3A:A8:6D:D9:CE:B8:7E:EF

            X509v3 Basic Constraints:
                CA:TRUE
    Signature Algorithm: sha256WithRSAEncryption
         1b:e7:f5:90:06:67:7c:bc:d0:c5:72:30:2d:8b:f4:14:95:3c:
         ea:a5:23:b9:e8:97:99:30:a5:b2:74:62:ff:e9:58:88:5d:3e:
         ...
         52:bd:ef:85:c7:ce:59:03:35:d4:23:26:9e:38:40:cf:34:82:
         7c:f2:db:ae:62:11:03:e8</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Create a configuration file <code>bucs558-ca.cnf</code> for future certificate generation and add the following content to it</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell"># we use 'ca' as the default section because we're using the ca command
[ ca ]
default_ca = bucs558-ca

[ bucs558-ca ]
# a text file containing the next serial number to use in hex. Mandatory.
# This file must be present and contain a valid serial number.
serial = ./serial

# the text database file to use. Mandatory. This file must be present though
# initially it will be empty.
database = ./index.txt

# specifies the directory where new certificates will be placed. Mandatory.
new_certs_dir = ./newcerts

# the file containing the CA certificate. Mandatory
certificate = ./bucs558-ca.crt

# the file contaning the CA private key. Mandatory
private_key = ./bucs558-ca.key

# the message digest algorithm. Remember to not use MD5
default_md = sha256

# for how many days will the signed certificate be valid
default_days = 30

# a section with a set of variables corresponding to DN fields
policy = bucs558-ca-policy

[ bucs558-ca-policy ]
# if the value is "match" then the field value must match the same field in the
# CA certificate. If the value is "supplied" then it must be present.
# Optional means it may be present. Any fields not mentioned are silently
# deleted.
countryName = match
stateOrProvinceName = supplied
organizationName = supplied
commonName = supplied
organizationalUnitName = optional
commonName = supplied
emailAddress = optional</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Run the following commands in the CA directory (<code>bucs558-ca</code>), in preparation of generating certificates.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">X:\ms-bu\sem-2\bu-cas-cs-558\cert-hw\bucs558-ca&gt;mkdir newcerts
X:\ms-bu\sem-2\bu-cas-cs-558\cert-hw\bucs558-ca&gt;touch index.txt
X:\ms-bu\sem-2\bu-cas-cs-558\cert-hw\bucs558-ca&gt;echo 01 &gt; serial</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_target_domain"><a class="anchor" href="#_target_domain"></a>Target Domain</h3>
<div class="ulist">
<ul>
<li>
<p>Pick a domain to target (<code>harshkapadia.me</code> here), create a directory for the domain (<code>harshkapadia.me</code> here).</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">X:\ms-bu\sem-2\bu-cas-cs-558\cert-hw&gt;mkdir harshkapadia.me
X:\ms-bu\sem-2\bu-cas-cs-558\cert-hw&gt;cd harshkapadia.me</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Generate a 4096 bit RSA private key and send the output to a file named <code>harshkapadia.me.key</code>.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">X:\ms-bu\sem-2\bu-cas-cs-558\cert-hw\harshkapadia.me&gt;openssl genrsa -out harshkapadia.me.key 4096
Generating RSA private key, 4096 bit long modulus (2 primes)
................................++++
...................................++++
e is 65537 (0x010001)</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Create a Certificate Signing Request (CSR) that the CA will use to generate a certificate for this domain.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">X:\ms-bu\sem-2\bu-cas-cs-558\cert-hw\harshkapadia.me&gt;openssl req -new -key harshkapadia.me.key -out harshkapadia.me.csr
You are about to be asked to enter information that will be incorporated
into your certificate request.
What you are about to enter is what is called a Distinguished Name or a DN.
There are quite a few fields but you can leave some blank
For some fields there will be a default value,
If you enter '.', the field will be left blank.
-----
Country Name (2 letter code) [AU]:US
State or Province Name (full name) [Some-State]:Massachusetts
Locality Name (eg, city) []:Boston
Organization Name (eg, company) [Internet Widgits Pty Ltd]:Harsh Kapadia
Organizational Unit Name (eg, section) []:hk
Common Name (e.g. server FQDN or YOUR name) []:harshkapadia.me
Email Address []:contact@harshkapadia.me

Please enter the following 'extra' attributes
to be sent with your certificate request
A challenge password []:
An optional company name []:</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Create an extensions configuration file <code>harshkapadia.me.extensions.cnf</code> and add the following content to it. This is mainly to add all the subdomains that can be authenticated by the certificate.</p>
<div class="ulist">
<ul>
<li>
<p>The <code>*.harshkapadia.me</code> entry implies that all the sub-domains of <code>harshkapadia.me</code> are covered by the certificate.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">basicConstraints=CA:FALSE
subjectAltName=@hk_subject_alt_names
subjectKeyIdentifier = hash

[ hk_subject_alt_names ]
DNS.1 = harshkapadia.me
DNS.2 = *.harshkapadia.me</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_creating_a_certificate_for_the_target_domain"><a class="anchor" href="#_creating_a_certificate_for_the_target_domain"></a>Creating a Certificate for the Target Domain</h3>
<div class="ulist">
<ul>
<li>
<p>All the configuration files required for generating a certificate have already been created above.</p>
</li>
<li>
<p>Generate a certificate for the target domain</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">X:\ms-bu\sem-2\bu-cas-cs-558\cert-hw\bucs558-ca&gt;openssl ca -config ./bucs558-ca.cnf -out ../harshkapadia.me/harshkapadia.me.crt -extfile ../harshkapadia.me/harshkapadia.me.extensions.cnf -in ../harshkapadia.me/harshkapadia.me.csr
Using configuration from ./bucs558-ca.cnf
Check that the request matches the signature
Signature ok
The Subject's Distinguished Name is as follows
countryName           :PRINTABLE:'US'
stateOrProvinceName   :ASN.1 12:'Massachusetts'
localityName          :ASN.1 12:'Boston'
organizationName      :ASN.1 12:'Harsh Kapadia'
organizationalUnitName:ASN.1 12:'hk'
commonName            :ASN.1 12:'harshkapadia.me'
emailAddress          :IA5STRING:'contact@harshkapadia.me'
Certificate is to be certified until May 12 21:53:40 2023 GMT (30 days)
Sign the certificate? [y/n]:y


1 out of 1 certificate requests certified, commit? [y/n]y
Write out database with 1 new entries
Data Base Updated</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>harshkapadia.me.crt</code> target domain certificate file should have been generated in the target domain&#8217;s directory (<code>harshkapadia.me</code> here). The details of the certificate can be printed and the certificate can be verified as well.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">X:\ms-bu\sem-2\bu-cas-cs-558\cert-hw\harshkapadia.me&gt;ls -a
.  ..  harshkapadia.me.crt  harshkapadia.me.csr  harshkapadia.me.extensions.cnf  harshkapadia.me.key  harshkapadia.me.pubkey

X:\ms-bu\sem-2\bu-cas-cs-558\cert-hw\harshkapadia.me&gt;openssl x509 -in harshkapadia.me.crt -noout -text # Certificate details
Certificate:
    Data:
        Version: 3 (0x2)
        Serial Number: 1 (0x1)
        Signature Algorithm: sha256WithRSAEncryption
        Issuer: C = US, ST = MA, L = Boston, O = BostonUniversityCS558, OU = CS558, CN = cs558.bu.edu, emailAddress = unsavorycaffine@bu.edu
        Validity
            Not Before: Apr 12 21:53:40 2023 GMT
            Not After : May 12 21:53:40 2023 GMT
        Subject: C = US, ST = Massachusetts, O = Harsh Kapadia, OU = hk, CN = harshkapadia.me, emailAddress = contact@harshkapadia.me
        Subject Public Key Info:
            Public Key Algorithm: rsaEncryption
                RSA Public-Key: (4096 bit)
                Modulus:
                    00:f2:56:53:c6:05:0e:a4:41:40:0d:3f:8b:bc:c6:
                    04:b5:6c:89:e3:8e:47:29:df:a6:b1:8c:18:3a:ed:
                    ...
                    22:bf:43:e1:a1:48:4d:8d:6d:ea:62:df:9f:61:b5:
                    38:79:35
                Exponent: 65537 (0x10001)
        X509v3 extensions:
            X509v3 Basic Constraints:
                CA:FALSE
            X509v3 Subject Alternative Name:
                DNS:harshkapadia.me, DNS:*.harshkapadia.me
            X509v3 Subject Key Identifier:
                7F:6C:46:27:5D:09:3C:F1:79:8E:3D:64:67:4F:F4:D1:C1:0E:88:6B
    Signature Algorithm: sha256WithRSAEncryption
         ab:fc:45:29:87:68:72:6a:4c:24:d2:e1:81:6b:11:40:78:a4:
         cc:c5:82:67:51:88:ad:35:5a:fc:e1:0f:69:71:ea:34:39:c0:
         ...
         18:eb:bd:76:76:b4:b7:c9:51:30:ab:4e:80:46:ce:14:cf:bc:
         64:0e:fd:3f:66:69:5e:87

X:\ms-bu\sem-2\bu-cas-cs-558\cert-hw\harshkapadia.me&gt;openssl verify -CAfile ../bucs558-ca/bucs558-ca.crt harshkapadia.me.crt # Verify certificate
harshkapadia.me.crt: OK</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>In the CA directory (<code>bucs558-ca</code>) some files have been generated</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">X:\ms-bu\sem-2\bu-cas-cs-558\cert-hw\bucs558-ca&gt;ls -a
.   bucs558-ca.cnf  bucs558-ca.key     index.txt       index.txt.old  serial
..  bucs558-ca.crt  bucs558-ca.pubkey  index.txt.attr  newcerts       serial.old

X:\ms-bu\sem-2\bu-cas-cs-558\cert-hw\bucs558-ca&gt;cat index.txt
V       230512215340Z           01      unknown /C=US/ST=Massachusetts/O=Harsh Kapadia/OU=hk/CN=harshkapadia.me/emailAddress=contact@harshkapadia.me

X:\ms-bu\sem-2\bu-cas-cs-558\cert-hw\bucs558-ca&gt;cat index.txt.old
# empty

X:\ms-bu\sem-2\bu-cas-cs-558\cert-hw\bucs558-ca&gt;cat index.txt.attr
unique_subject = yes

X:\ms-bu\sem-2\bu-cas-cs-558\cert-hw\bucs558-ca&gt;cat serial
02 # The next serial number was automatically generated

X:\ms-bu\sem-2\bu-cas-cs-558\cert-hw\bucs558-ca&gt;cat serial.old
01 # The last serial number that was manually configured

X:\ms-bu\sem-2\bu-cas-cs-558\cert-hw\bucs558-ca&gt;ls -a newcerts
.  ..  01.pem # The CA has a copy of the certificate with the serial number as the title</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_configuring_host_operating_system"><a class="anchor" href="#_configuring_host_operating_system"></a>Configuring Host Operating System</h3>
<div class="ulist">
<ul>
<li>
<p>In this case, the host Operating System (OS) is Microsoft Windows 11.</p>
</li>
<li>
<p>To be able to redirect the target domain to another web page, it has to be redirected on the OS.</p>
<div class="paragraph">
<p>Add the following lines to the <code>C:\Windows\System32\drivers\etc\hosts</code> file.</p>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">\# Added by Harsh Kapadia for BU CAS CS 558
127.0.0.1 harshkapadia.me
127.0.0.1 networking.harshkapadia.me</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The sub-domains of <code>harshkapadia.me</code> (eg: <code>networking.harshkapadia.me</code>) have to be added individually, as the <code>hosts</code> file does not support wildcards (<code>*.harshkapadia.me</code>).
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p>To serve an alternate page once the domain is hijacked, create an <code>index.html</code> file outside the CA and target domain directories.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">X:\ms-bu\sem-2\bu-cas-cs-558\cert-hw&gt;vim index.html # Add content shown below
X:\ms-bu\sem-2\bu-cas-cs-558\cert-hw&gt;cat index.html
&lt;html&gt;
        &lt;head&gt;
                &lt;title&gt;Harsh Kapadia&lt;/title&gt;
        &lt;/head&gt;

        &lt;body style="text-align: center;"&gt;
                &lt;h1&gt;Harsh Kapadia&lt;/h1&gt;
        &lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>The CA certificate (<code>bucs558-ca.crt</code>) is a root certificate that is providing trust to the certificate (<code>harshkapadia.me.crt</code>) that we created for the target domain (<code>harshkapadia.me</code>). The host OS and browser doesn&#8217;t trust the CA root certificate (<code>bucs558-ca.crt</code>) though, so the domain certificate (<code>harshkapadia.me.crt</code>) won&#8217;t be accepted. So, the root certificate (<code>bucs558-ca.crt</code>) needs to be added to the OS&#8217;s certificate store manually. Adding the root certificate separately to the browser&#8217;s key store might also be required (like in Mozilla Firefox, as shown below).</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="./img/windows-cert-store.png" alt="windows cert store">
</div>
<div class="title">Microsoft Windows' Certificate Store</div>
</div>
<div class="imageblock">
<div class="content">
<img src="./img/firefox-cert-store.png" alt="firefox cert store">
</div>
<div class="title">Mozilla Firefox&#8217;s Certificate Store</div>
</div>
<div class="ulist">
<ul>
<li>
<p>To be able to carry out the attack, there has to be a TLS terminating server (<a href="https://www.openssl.org/docs/man3.1/man1/openssl-s_server.html" target="_blank" rel="noopener"><code>openssl s_server</code></a>) running that captures the request to the target domain (<code>harshkapadia.me</code>) that was redirected to <code>127.0.0.1</code> (<code>localhost</code>) by the OS due to the <code>host</code> file configuration above.</p>
<div class="ulist">
<ul>
<li>
<p>The server is listening at port 443, as that is the default port for HTTPS requests.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The command below has to be run from the directory where the <code>index.html</code> file was created.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">X:\ms-bu\sem-2\bu-cas-cs-558\cert-hw&gt;openssl s_server -accept 127.0.0.1:443 -cert ./harshkapadia.me/harshkapadia.me.crt -cert_chain ./bucs558-ca/bucs558-ca.crt -key ./harshkapadia.me/harshkapadia.me.key -WWW
Using default temp DH parameters
ACCEPT
FILE:index.html
FILE:index.html
FILE:index.html
FILE:index.html</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_accessing_the_target_domain"><a class="anchor" href="#_accessing_the_target_domain"></a>Accessing the Target Domain</h3>
<div class="ulist">
<ul>
<li>
<p>Now on going to <code><a href="https://harshkapadia.me/index.html" class="bare">https://harshkapadia.me/index.html</a></code> or <code><a href="https://networking.harshkapadia.me/index.html" class="bare">https://networking.harshkapadia.me/index.html</a></code>, instead of seeing the original web site, the highjacked <code>index.html</code> file is visible with a lock beside the URL, which means that the browser accepted the phony certificates that we presented it. Thus, the browser has been tricked.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_original_web_pages"><a class="anchor" href="#_original_web_pages"></a>Original Web Pages</h4>
<div class="paragraph">
<p>This is how the two web pages looked before hijacking:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./img/og-domain-page.png" alt="og domain page">
</div>
<div class="title">Base domain: <code><a href="https://harshkapadia.me/index.html" class="bare">https://harshkapadia.me/index.html</a></code></div>
</div>
<div class="imageblock">
<div class="content">
<img src="./img/og-sub-domain-page.png" alt="og sub domain page">
</div>
<div class="title">Sub domain: <code><a href="https://networking.harshkapadia.me/index.html" class="bare">https://networking.harshkapadia.me/index.html</a></code></div>
</div>
</div>
<div class="sect3">
<h4 id="_mozilla_firefox"><a class="anchor" href="#_mozilla_firefox"></a>Mozilla Firefox</h4>
<div class="paragraph">
<p>After the hijacking:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./img/firefox-home-page.png" alt="firefox home page">
</div>
<div class="title">Base domain: <code><a href="https://harshkapadia.me/index.html" class="bare">https://harshkapadia.me/index.html</a></code></div>
</div>
<div class="imageblock">
<div class="content">
<img src="./img/firefox-security.png" alt="firefox security">
</div>
<div class="title">Firefox&#8217;s site security dialog box</div>
</div>
<div class="imageblock">
<div class="content">
<img src="./img/firefox-leaf-cert.png" alt="firefox leaf cert">
</div>
<div class="title">The leaf (domain) certificate as seen in Firefox</div>
</div>
<div class="imageblock">
<div class="content">
<img src="./img/firefox-root-cert.png" alt="firefox root cert">
</div>
<div class="title">The root (CA) certificate as seen in Firefox</div>
</div>
</div>
<div class="sect3">
<h4 id="_microsoft_edge"><a class="anchor" href="#_microsoft_edge"></a>Microsoft Edge</h4>
<div class="paragraph">
<p>After the hijacking:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./img/edge-home-page.png" alt="edge home page">
</div>
<div class="title">Base domain: <code><a href="https://harshkapadia.me/index.html" class="bare">https://harshkapadia.me/index.html</a></code></div>
</div>
<div class="imageblock">
<div class="content">
<img src="./img/edge-leaf-cert-1.png" alt="edge leaf cert 1">
</div>
<div class="title">General view of the leaf (domain) certificate as seen in Edge</div>
</div>
<div class="imageblock">
<div class="content">
<img src="./img/edge-leaf-cert-2.png" alt="edge leaf cert 2">
</div>
<div class="title">Hierarchical view of certificates as seen in Edge</div>
</div>
<div class="imageblock">
<div class="content">
<img src="./img/edge-sub-domain-page.png" alt="edge sub domain page">
</div>
<div class="title">Sub domain: <code><a href="https://networking.harshkapadia.me/index.html" class="bare">https://networking.harshkapadia.me/index.html</a></code></div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2023-04-13 00:39:44 UTC
</div>
</div>
</body>
</html>